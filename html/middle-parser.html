<html>

<head>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
</head>

<body>
    <style>
        #txt_input {
            width: 100%;
            height: 300px;
        }

        #txt_output {
            width: 100%;
            height: 450px;
        }
    </style>

    <script>
        var importedData="DATA_DATA_DATA";
        var time = 0;
        var results = [];
        var resultsInstant = [];
        function UserProcessor() {
            var inputOrign = $("#txt_input").val();
            while (inputOrign.search("\nSAMPLE DATA __") > -1) {
                resultsInstant = [];
                var input = inputOrign.substr(inputOrign.search("\nSAMPLE DATA __"), inputOrign.search("\nURL TRACE ") + 10);

                inputOrign = inputOrign.substr(inputOrign.search("\nURL TRACE ") + 10, inputOrign.length);

                //alert(input);
                var breakList = input.split("\n");
                for (var x = 2; x < breakList.length - 1; x++) {
                    if (breakList[x] === "") {
                        continue;
                    }
                    else {
                        resultsInstant[resultsInstant.length] = breakList[x];
                    }
                }
                if (time === 0) {
                    time = 1;
                    results[0] = '"User ID","' + resultsInstant[0].replace("USER ID: ", "");
                    results[1] = '"Caminho","' + resultsInstant[1].replace("PATH: ", "");
                    results[2] = '"STATUS","' + resultsInstant[2].replace("STATUS: ", "");
                    results[3] = '"URL Inicial","' + resultsInstant[3].replace("URL: ", "");
                    results[4] = '"Time spent (s)","' + resultsInstant[4].replace("Time spent (s): ", "");
                    results[5] = '"Clicks","' + resultsInstant[5].replace("Clicks: ", "");
                    results[6] = '"Distance to find objects (px)","' + resultsInstant[6].replace("Distance to find objects (px): ", "");
                    results[7] = '"Total Distance (px)","' + resultsInstant[7].replace("Total Distance (px): ", "");
                    results[8] = '"Total Eye Distance (px)","' + resultsInstant[8].replace("Total Eye Distance (px): ", "");
                    results[9] = '"Ideal Distance (px)","' + resultsInstant[9].replace("Ideal Distance (px): ", "");
                    results[10] = '"Total / Ideal Distance","' + resultsInstant[10].replace("Total / Ideal Distance: ", "").replace(" X", "");
                    results[11] = '"Wait To Click (s)","' + resultsInstant[11].replace("Wait To Click (s): ", "");
                    results[12] = '"Fixation To Click (s)","' + resultsInstant[12].replace("Fixation To Click (s): ", "");
                    results[13] = '"Page returns","' + resultsInstant[13].replace("Page returns: ", "");
                    results[14] = '"Page repeatitions","' + resultsInstant[14].replace("Page repeatitions: ", "");
                    results[15] = '"Keylog","' + resultsInstant[15].replace("Keylog: ", "");
                }
                else {
                    results[0] += '","' + resultsInstant[0].replace("USER ID: ", "");
                    results[1] += '","' + resultsInstant[1].replace("PATH: ", "");
                    results[2] += '","' + resultsInstant[2].replace("STATUS: ", "");
                    results[3] += '","' + resultsInstant[3].replace("URL: ", "");
                    results[4] += '","' + resultsInstant[4].replace("Time spent (s): ", "");
                    results[5] += '","' + resultsInstant[5].replace("Clicks: ", "");
                    results[6] += '","' + resultsInstant[6].replace("Distance to find objects (px): ", "");
                    results[7] += '","' + resultsInstant[7].replace("Total Distance (px): ", "");
                    results[8] += '","' + resultsInstant[8].replace("Total Eye Distance (px): ", "");
                    results[9] += '","' + resultsInstant[9].replace("Ideal Distance (px): ", "");
                    results[10] += '","' + resultsInstant[10].replace("Total / Ideal Distance: ", "").replace(" X", "");
                    results[11] += '","' + resultsInstant[11].replace("Wait To Click (s): ", "");
                    results[12] += '","' + resultsInstant[12].replace("Fixation To Click (s): ", "");
                    results[13] += '","' + resultsInstant[13].replace("Page returns: ", "");
                    results[14] += '","' + resultsInstant[14].replace("Page repeatitions: ", "");
                    results[15] += '","' + resultsInstant[15].replace("Keylog: ", "");
                }
                var output = "";
                for (var x = 0; x < results.length; x++) {
                    output += results[x] + '"\n';
                }
                $("#txt_output").val(output);

            }
        }
            // $("#txt_input").val(atob(importedData));
            // UserProcessor();
            // $.post( "http://localhost/webtracer/csv-parser.php", { data: $("#txt_output").val() } );
            // alert($("#txt_input").val(product));
            // window.close();
        


    </script>
    <textarea id="txt_input">

        </textarea>
    <center><button type="button" id="convert" onclick="UserProcessor()">Convert!</button></center>
    <textarea id="txt_output">

            </textarea>
</body>

</html>